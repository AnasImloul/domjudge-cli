[importlinter]
root_package = dom
include_external_packages = False

# Keep the directional layering (allows downward imports, blocks upward ones).
[importlinter:contract:layered-architecture]
name = Enforce layered architecture (CLI -> Operations -> Services -> Infrastructure)
type = layers
layers =
    dom.cli
    dom.core.operations
    dom.core.services
    dom.infrastructure

# Forbid DIRECT layer skipping (but allow transitive deps through the middle layer).
[importlinter:contract:no-skip-from-cli]
name = No direct skipping from CLI to Services/Infrastructure
type = forbidden
source_modules =
    dom.cli
forbidden_modules =
    dom.core.services
    dom.infrastructure
allow_indirect_imports = True

[importlinter:contract:no-skip-from-operations]
name = No direct skipping from Operations to Infrastructure
type = forbidden
source_modules =
    dom.core.operations
forbidden_modules =
    dom.infrastructure
allow_indirect_imports = True
